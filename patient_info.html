<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<title>ç—…æ‚£è³‡æ–™è¼¸å…¥</title>
<style>
  body{
    font-family: -apple-system, BlinkMacSystemFont, 'Noto Sans TC';
    background:#e8f4ff;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    margin:0;
  }
  .box{
    background:white;
    padding:24px 32px;
    border-radius:12px;
    width:320px;
    box-shadow:0 6px 18px rgba(0,0,0,0.1);
  }
  h2{margin-top:0;text-align:center;}
  .input{margin-bottom:14px;}
  label{font-weight:600;}
  input,select{
    width:100%;padding:8px;border-radius:6px;border:1px solid #ccc;margin-top:4px;
  }
  button{
    width:100%;padding:10px;background:#0b5ed7;color:white;border:none;
    font-size:16px;border-radius:6px;cursor:pointer;margin-top:14px;
  }
</style>
</head>
<body>
<div class="box">
  <h2>è«‹è¼¸å…¥ç—…æ‚£è³‡æ–™</h2>

  <div class="input">
    <label>å§“åï¼š</label>
    <input id="name" type="text">
  </div>

  <div class="input">
    <label>æ€§åˆ¥ï¼š</label>
    <select id="gender">
      <option value="ç”·">ç”·</option>
      <option value="å¥³">å¥³</option>
    </select>
  </div>

  <div class="input">
    <label>å‡ºç”Ÿå¹´æœˆæ—¥ï¼š</label>
    <input id="birth" type="date">
  </div>

  <div class="input">
    <label>èº«åˆ†è­‰å­—è™Ÿï¼š</label>
    <input id="idno" type="text">
  </div>

  <button onclick="go()">å„²å­˜</button>
</div>

<script>
window.addEventListener("DOMContentLoaded", () => {
  
  const mode = localStorage.getItem("edit_mode");

  if (mode === "info") {
    // åªæœ‰åœ¨ä¿®æ”¹æ¨¡å¼æ‰å¸¶å…¥éå»è³‡æ–™
    document.getElementById("name").value   = localStorage.getItem("patient_name")   || "";
    document.getElementById("gender").value = localStorage.getItem("patient_gender") || "";
    document.getElementById("birth").value  = localStorage.getItem("patient_birth")  || "";
    document.getElementById("idno").value   = localStorage.getItem("patient_id")     || "";
  } else {
    // æ–°å¢æ™‚ä¿æŒç©ºç™½
    document.getElementById("name").value   = "";
    document.getElementById("gender").value = "ç”·"; // é è¨­
    document.getElementById("birth").value  = "";
    document.getElementById("idno").value   = "";
  }
});
function go(){
  const name = document.getElementById('name').value.trim();
  const gender = document.getElementById('gender').value;
  const birth = document.getElementById('birth').value;
  const idno = document.getElementById('idno').value.trim();

  if(!name || !birth || !idno){
    alert("è«‹å®Œæ•´å¡«å¯«æ‰€æœ‰æ¬„ä½");
    return;
  }

  // å„²å­˜è³‡æ–™
  localStorage.setItem("patient_name", name);
  localStorage.setItem("patient_gender", gender);
  localStorage.setItem("patient_birth", birth);
  localStorage.setItem("patient_id", idno);

  // è®€å–æ¨¡å¼ï¼ˆæ˜¯å¦ç‚ºä¿®æ”¹ï¼‰
  const mode = localStorage.getItem("edit_mode");

  if (mode === "info") {
    // ğŸŒŸ ä¿®æ”¹æ¨¡å¼ â†’ å› dashboard
    localStorage.removeItem("edit_mode");
    window.location.href = "/dashboard";
  } else {
    // ğŸŒŸ æ–°å¢æ¨¡å¼ï¼ˆç¬¬ä¸€æ¬¡å¡«ï¼‰â†’ å» input2
    window.location.href = "/input2";
  }
}
</script>
</body>
</html>
